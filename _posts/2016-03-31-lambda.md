---
layout: post
title: Pythonでlambda計算の基礎
keywords: python, ラムダ計算, lambda, チャーチ数
tags:
  - Python
  - lambda
---

ラムダ式、関数型、流行ってますね。

今回はラムダ計算理論の超基礎&Pythonでのサンプルコード載せます。
HaskellやML系は私がまともに書けないのでPythonで書きます。

## lambda計算基礎

入力に対して1を加算して返す関数`f(x) = x + 1`を考えます。
このfは何を表すのか？ということ考えると、fという名前には本質情報はありません。
fでもgでもhでもいいですね。なので関数の本質を表すラムダ式の記法を用いると、以下の表記になります。

~~~
λx.x+1
~~~

**「xを入力にとって、x+1を返す」**関数です。簡単ですね。

実際に入力を与える場合は以下のように書きます。

~~~
( λx.x+1 ) 5
= 5 + 1
= 6
~~~

このように、関数に入力値を与える、すなわち関数を呼び出す手続きのことを**関数適用**と言います。
また、2行目でxを5に置き換えてる操作を**β変換**といいます。
簡単ですね。

複数引数の場合は

~~~
λxy.x+y
~~~

みたいに書けます。
ただし、複数引数の関数は1引数関数の組み合わせで凡そ表現できます。

1引数関数だけを使って明示的に表現すると、以下のようになります。

~~~
λx.(λy.x+y)
~~~

一般的に、2引数以上の関数を1引数関数化する操作を**カリー化**と言います。重要な概念です。

## チャーチ数

ラムダ計算自体には0, 1, 2, 3...といった所謂自然数を表す記号や、`+,-`等の演算記号を持ちません。
じゃあどうやって数値計算するの？って話なのですが、そこがラムダ計算の面白いところの一部です。

まず、**チャーチ数**というものが唐突に登場します。
チャーチ数C_nは以下のように定義されています。

~~~
C_0 = λfx.x
C_1 = λfx.f(x)
C_2 = λfx.f(f(x))
C_3 = λfx.f(f(f(x)))
C_4 = λfx.f(f(f(f(x))))
...
~~~

見てわかるように、チャーチ数自体はそれぞれラムダ式であり関数です。
いわゆる自然数とかではないですね。

さて、ここで唐突に以下の`A_+`というラムダ式が登場します。

~~~
A_+ = λxypq.xp(ypq)
~~~

( 結合則等のルールは基本左結合です。)

なんと、以下のβ変換が成り立ちます。

~~~
A_+ c_m c_n = c_m+n
~~~

チャーチ数と`A_+`というラムダ式で加算が表現できています。
こんな感じでいろいろな演算を表現できます。すごいですね。

## lambda計算における加算

上記の例をpythonで書きました。
pythonの構文上lambda式は複数引数取れますが、
今回は全てカリー化しています。

~~~python
# coding: utf-8
# church数 0,1,2,3
ZERO  = lambda f: lambda x: x
ONE   = lambda f: lambda x: f(x)
TWO   = lambda f: lambda x: f(f(x))
THREE = lambda f: lambda x: f(f(f(x)))

# church数 -> intの変換関数
def church_to_int(f):
    return f(lambda x:x + 1)(0)

print church_to_int(ZERO)
# => 0
print church_to_int(ONE)
# => 1
print church_to_int(TWO)
# => 2

# church数における加算表現
ADD = lambda x: lambda y: lambda p: lambda q: x(p)(y(p)(q))

print church_to_int(ADD(TWO)(THREE))
# => 5 <- !?
print church_to_int(ADD(THREE)(THREE))
# => 6 <- !?
~~~

ラムダ計算の初歩of初歩でした。
まだまだ勉強中です。
